<nav class="navbar navbar-expand-lg">
  <div class="container-fluid d-flex justify-content-start">
     <select class="form-select" aria-label="Default select example" [ngModel]="month" (ngModelChange)="getRosterData($event)">
      <option selected>Option</option> 
      @for(month of monthList; track month){
        <option [value]="month">{{month}}</option>
      }@empty{
        <p>no Value</p>
      }
    </select> 
  </div>
  

    <a class="navbar-brand" href="#">Roster</a>
  
    <div class="container-fluid d-flex justify-content-end">
      <button class="btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
          <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
        </svg>
      </button> 
      <button class="btn ms-2 btn-primary" type="submit" (click)="routeBack()">Home</button> 
  
    </div>  
  </nav>

  <div class="container-fluid mt-3">
    @if(rosterData.length > 0){
    <table class="table mt-3">  
        <thead class="p-0 m-0"> 
          <tr class="head-section"> 
              <th class="name-title">Name</th>
              @for (day of dateObject; track day){
                <th *ngIf="day" class="text-center date"> 
                  {{ day?.day }}  
                  <br> 
                <small>{{day?.date}}</small>  
  
                  </th>  
              }   
          </tr> 
          <br>
        </thead> 
       
          <tbody class="table-body" >
            @for (item of rosterData; track item.roster) {
    
              <tr *ngIf="item" class="">
                <td *ngIf="item" class="username-column" >
                  {{ item.username }}  
                </td>
                @for (data of item.roster; track data?.dayNumber) {
                  <td *ngIf="data" class="cal-input" [style.backgroundColor]="data.option == 'PH' ? '#4DFF3D': data.option == 'CO'? '#FDE253': data.option == 'L'? '#FF5858' :  data.option == 'WO' ? '#B6D7A8': 'transparent'"> 
                      {{data.option}}
                  </td>
                }@empty{
                  <p>No Data for</p>
                }
              </tr>
            } @empty{ 
              <tr>
                <td colspan="16" class="text-center">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div> 
                </td>
               
              </tr> 
            }
          </tbody> 
      </table> 
    }@else {
      <div class="jumbotron text-center mt-3">
       <h5 class="text-danger">
         Roster not published for {{month}}
       </h5>
      </div>
     }
  </div>




  <div id="mySidenav" class="sidenav" [ngStyle]="{ height: isOpen ? '320px' : '0' }">
    <span class="user">Shift users overview</span>
    <a href="javascript:void(0)" class="closebtn" (click)="toggleSidebar()">&times;</a>
    <div class="table-container">
      <table class="custom-table">
        <thead class="custom-thead">
          <tr class="custom-tr">
            <th class="custom-th">Shift</th>
            <!-- Display dates in the header row -->
            <ng-container *ngFor="let day of dateObject">
              <th *ngIf="day" class="custom-th">{{ day.date }}</th>
            </ng-container>
          </tr>
        </thead>
        <tbody>
          <!-- Iterate through prepared data -->
          <ng-container *ngFor="let rowData of prepareDataForTable(); let rowIndex = index">
            <tr class="custom-tr">
              <td class="custom-td">{{ rowData.shift }}</td>
              <!-- Iterate through counts -->
              <ng-container *ngFor="let count of rowData.counts; let i = index">
                <td class="custom-td text-center" [style.backgroundColor]="rowData.shift == 'PH' && count !== 0 ? '#4DFF3D': rowData.shift == 'WO' && count !== 0 ? '#B6D7A8': rowData.shift == 'L' && count !== 0 ?'#FF5858': rowData.shift == 'CO' && count !== 0 ? '#FDE253' : 'transparent'">{{ count }}</td>
              </ng-container>
            </tr>
            <tr class="custom-tr" *ngIf="rowIndex === prepareDataForTable().length - 1">
              <td class="custom-td">Total</td>
              <!-- Iterate through total counts -->
              <ng-container *ngFor="let total of getTotalCounts(); let i = index">
                <td class="custom-td text-center">{{ total }}</td>
              </ng-container>
            </tr>
          </ng-container>
          <!-- Show message if no data -->
          <tr *ngIf="!prepareDataForTable().length">
            <td class="custom-td text-center">No Data for {{ month }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  
    
    
    
    
  </div>
  
  <button class="btn btn-primary semi-circle-btn" (click)="toggleSidebar()">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-bar-up" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M8 10a.5.5 0 0 0 .5-.5V3.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 3.707V9.5a.5.5 0 0 0 .5.5m-7 2.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5"/>
    </svg>
  </button>